<link rel="stylesheet" href="app/policy/templates/policyDefinition/templates/detection/style.css" />
<div ng-http-loader methods="['POST']" template="app/common/templates/loader.html" ttl="1"></div>
<md-button md-ink-ripple="white" md-whiteframe="6" class="editDetection" aria-label="edit preferences" edit-preferences>EDIT</md-button>
<json-formatter json="ctrl.PolicyFacets"></json-formatter>
<div layout='column' id="policySettingsContainer">
    <div layout='row' layout-margin ng-repeat="(Key, value) in ctrl.DetectionFacets">
        <md-list class='whiteBk policy_settings_lists' md-whiteframe="4">
            <md-list-item layout='row' layout-align='start center' class="policy_settings_key">
                <h4 class='card-title'>{{Key}}</h4>
            </md-list-item>
            <md-divider></md-divider>
            <md-list-item layout='row' layout-align='space-between center' ng-repeat="(propkey, propValue) in value.Properties">
                <p>
                    <button ng-show="propValue.Type === 'FacetPropertyType_Bool, FacetPropertyType_MultiChoice'">show</button>
                    {{propValue.DisplayName}}
                </p>
                <div ng-switch="propValue.Type" ng-init=" ctrl.PolicyFacets[Key].Values[propkey] = ctrl.PolicyFacets[Key].Values[propkey] == null ? propValue.DefaultValue :  ctrl.PolicyFacets[Key].Values[propkey]">
                    <div ng-switch-when="FacetPropertyType_Bool">
                        <md-switch ng-true-value="'True'" ng-false-value="'False'" class="custom-switch" ng-model="ctrl.PolicyFacets[Key].Values[propkey]"
                            aria-label="file Sign switch">
                        </md-switch>
                    </div>
                    <div ng-switch-when="FacetPropertyType_Bool, FacetPropertyType_MultiChoice" ng-init="propValue.AvailableValues = ['something1', 'something2']">
                        <md-list-item ng-repeat="x in propValue.AvailableValues">
                            {{x}}
                            <md-checkbox ng-model="ctrl.PolicyFacets[Key].Values[propkey][x]"></md-checkbox>
                        </md-list-item>
                    </div>
                    <div ng-switch-when="FacetPropertyType_Int" name="file">
                        <input class="custom-input" placeholder="int" ng-model="ctrl.PolicyFacets[Key].Values[propkey]" type="text" />
                    </div>
                    <div ng-switch-when=" FacetPropertyType_String">
                        <input class="custom-input" placeholder="text" ng-model="ctrl.PolicyFacets[Key].Values[propkey]" type="text" />
                    </div>
                    <div ng-switch-when="FacetPropertyType_MultiLineString">
                        <textarea ng-model="ctrl.PolicyFacets[Key].Values[propkey]"></textarea>
                    </div>
                    <div ng-switch-when="FacetPropertyType_SingleChoice">
                        <select class="custom-select" ng-init="ctrl.PolicyFacets[Key].Values[propkey] = $index" ng-model="ctrl.PolicyFacets[Key].Values[propkey]"
                            md-whiteframe="3">
                         <option ng-repeat="x in propValue.AvailableValues track by $index" ng-selected = "ctrl.PolicyFacets[Key].Values[propkey]" value="{{$index}}" >{{x}}</option>
                         </select>
                    </div>
                    <div ng-switch-when=" FacetPropertyType_Password">
                        <input class="custom-input" aria-label="key" placeholder="" ng-model="ctrl.PolicyFacets[Key].Values[propkey]" type="password"
                        />
                    </div>
                </div>
                <md-divider></md-divider>
            </md-list-item>
        </md-list>
    </div>
    <!--<div id="detectClick" check-if-editable>
    <div id="detectionWrapper" class="notEditable">
        <table md-whiteframe="6" class="detectionTables table table-responsive" match-width>
            <thead>
                <th class="verticalMargin" id="copyMyWidth">
                    <div layout="row" layout-align="start center" class="this">
                        <md-icon class="noMargin">list</md-icon>
                        <p class="noMarginBottom">SCANNERS</p>
                    </div>
                </th>
                <th class="verticalMargin">
                    <div layout="row" layout-align="start center">
                        <md-checkbox aria-label="useAll" class="noMarginBottom" ng-model="ctrl.detection.useAll" use-all></md-checkbox>
                        <p class="noMarginBottom">USE</p>
                    </div>
                </th>
            </thead>
            <tbody>
                <tr class="verticalMargin">
                    <td class="this">Avira</td>
                    <td>
                        <md-checkbox aria-label="avira" class="noMarginBottom" ng-model="ctrl.detection.avira.IsSelected"></md-checkbox>
                    </td>
                </tr>
                <tr class="verticalMargin">
                    <td class="this">Clam</td>
                    <td>
                        <md-checkbox aria-label="clam" class="noMarginBottom" ng-model="ctrl.detection.clam.IsSelected"></md-checkbox>
                    </td>
                </tr>
            </tbody>
        </table>
       
        <table md-whiteframe="6" class="detectionTables table table-responsive">
            <tbody>
                <tr class="verticalMargin">
                    <td class="this" unwrapp-fireye>
                        <md-icon class="material-icons">keyboard_arrow_right</md-icon>
                        FireEye Sandbox
                    </td>
                    <td>
                        <md-checkbox aria-label="use cuckoo" ng-model="ctrl.detection.fireEye.IsSelected"></md-checkbox>
                    </td>
                </tr>
                
                <tr class="fireEye hidden animated fadeIn" ng-repeat="fireEye in ctrl.fireEye_servers_list">
                    <td>
                        <md-icon>some_icon</md-icon>
                        {{fireEye}}
                    </td>
                    <td>
                        <md-checkbox aria-label="fireEye" ng-model="ctrl.detection.FileDetectionSettings.ServerAddress[fireEye]"></md-checkbox>
                    </td>
                </tr>
               
                <tr class="verticalMargin">
                    <td class="this" unwrapp-cukoo>
                        <md-icon class="material-icons">keyboard_arrow_right</md-icon>
                        Cukoo Sandbox
                    </td>
                    <td>
                        <md-checkbox aria-label="use cuckoo" ng-model="ctrl.detection.cuckoo.IsSelected"></md-checkbox>
                    </td>
                </tr>
                
                <tr class="cukoo hidden animated fadeIn" ng-repeat="cuckoo in ctrl.cukoo_servers_list">
                    <td>
                        <md-icon class="material-icons">some_icon</md-icon>
                        {{cuckoo}}
                    </td>
                    <td>
                        <md-checkbox aria-label="useServers" ng-model="ctrl.detection.FileDetectionSettings.cuckooServers[cuckoo].IsSelected"></md-checkbox>
                    </td>
                </tr>
           
                <tr class="cukoo hidden animated fadeIn">
                    <td>
                        <md-icon class="material-icons">someicon</md-icon>
                        Timeout (Milliseconds)
                    </td>
                    <td>
                        <input ng-model="ctrl.detection.cukoo.FileDetectionSettings.TimeOutMillis" placeholder="milliseconds" type="number" />
                    </td>
                </tr>
          
                <tr class="cukoo hidden animated fadeIn">
                    <td>
                        <md-icon class="material-icons">someicon</md-icon>
                        Save Reports
                    </td>
                    <td>
                        <md-checkbox ng-model="ctrl.detection.cukoo.FileDetectionSettings.saveReports"></md-checkbox>
                    </td>
                </tr>
            </tbody>
          
        </table>
        <table md-whiteframe="6" class="detectionTables table table-responsive">
            <tbody>
                <tr class="verticalMargin">
                    <td class="this">Vendor Signing</td>
                    <td>
                        <md-checkbox aria-label="vendor" class="noMarginBottom" ng-model="ctrl.detection.vendorSigning.IsSelected"></md-checkbox>
                    </td>
                </tr>
                <tr class="verticalMargin">
                    <td class="this">XML Validation</td>
                    <td>
                        <md-checkbox aria-label="xml" class="noMarginBottom" ng-model="ctrl.detection.xmlValidation.IsSelected"></md-checkbox>
                    </td>
                </tr>
                <tr class="verticalMargin">
                    <td class="this">Regular Expression</td>
                    <td>
                        <md-checkbox aria-label="regex" class="noMarginBottom" ng-model="ctrl.detection.regex.IsSelected"></md-checkbox>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>
</div>-->